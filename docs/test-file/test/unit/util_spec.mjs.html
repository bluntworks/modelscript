<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">test/unit/util_spec.mjs | ModelScript</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Modelscript is a javascript module with simple and efficient tools for data mining and data analysis in JavaScript. When modelscript used with ML.js, pandas-js, and numjs, you&apos;re left with the equialent R/Python toolset in JavaScript"><meta property="og:type" content="website"><meta property="og:url" content="https://repetere.github.io/modelscript"><meta property="og:site_name" content="ModelScript"><meta property="og:title" content="ModelScript"><meta property="og:image" content="https://repetere.ai/favicon.png"><meta property="og:description" content="Modelscript is a javascript module with simple and efficient tools for data mining and data analysis in JavaScript. When modelscript used with ML.js, pandas-js, and numjs, you&apos;re left with the equialent R/Python toolset in JavaScript"><meta property="og:author" content="https://github.com/repetere"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="ModelScript"><meta property="twitter:description" content="Modelscript is a javascript module with simple and efficient tools for data mining and data analysis in JavaScript. When modelscript used with ML.js, pandas-js, and numjs, you&apos;re left with the equialent R/Python toolset in JavaScript"><meta property="twitter:image" content="https://repetere.ai/favicon.png"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/repetere/modelscript"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ColumnVectorizer.mjs~ColumnVectorizer.html">ColumnVectorizer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/DataSet.mjs~DataSet.html">DataSet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ReinforcedLearning.mjs~ReinforcedLearningBase.html">ReinforcedLearningBase</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ReinforcedLearning.mjs~ThompsonSampling.html">ThompsonSampling</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ReinforcedLearning.mjs~UpperConfidenceBound.html">UpperConfidenceBound</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-assocationRuleLearning">assocationRuleLearning</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getTransactions">getTransactions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadCSV">loadCSV</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadCSVURI">loadCSVURI</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-loadTSV">loadTSV</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-calc">calc</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cross_validation">cross_validation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PD">PD</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-calc">calc</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cross_validation">cross_validation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-csv">csv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-loadCSV">loadCSV</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-loadCSVURI">loadCSVURI</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ml">ml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-model_selection">model_selection</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-nlp">nlp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-preprocessing">preprocessing</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-util">util</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ml">ml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-nlp">nlp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PD">PD</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-util">util</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">test/unit/util_spec.mjs</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import * as ms from &apos;../../index.mjs&apos;;
import chai from &apos;chai&apos;;
const expect = chai.expect;
const testArray = [20, 25, 10, 33, 50, 42, 19,];
const vectors = [
  [1, 2, 3, ],
  [1, 2, 3, ],
  [3, 3, 4, ],
  [3, 3, 3, ],
];
const arrays = [
  [1, 1, 3, 3,],
  [2, 2, 3, 3,],
  [3, 3, 4, 3,],
];

describe(&apos;util&apos;, function () { 
  describe(&apos;max&apos;, () =&gt; {
    it(&apos;should return max value&apos;, () =&gt; {
      expect(ms.util).to.be.an(&apos;object&apos;);
      expect(ms.util.max(testArray)).to.equal(50);   
    });
  });
  describe(&apos;min&apos;, () =&gt; {
    it(&apos;should return min value&apos;, () =&gt; {
      expect(ms.util.min(testArray)).to.equal(10);   
    });
  });
  describe(&apos;mean&apos;, () =&gt; {
    it(&apos;should return mean value&apos;, () =&gt; {
      expect(ms.util.mean(testArray)).to.equal(ms.util.sum(testArray) / testArray.length);   
    });
  });
  describe(&apos;Standard Scaler Transforms&apos;, () =&gt; { 
    const standardScaledTestArray = ms.util.StandardScaler(testArray);
    const standardScaledTransformsTestObj = ms.util.StandardScalerTransforms(testArray);
    it(&apos;should return an object with a scale function, descale function and values array&apos;, () =&gt; {
      expect(standardScaledTransformsTestObj).to.be.an(&apos;object&apos;);
      expect(standardScaledTransformsTestObj).to.have.property(&apos;scale&apos;);
      expect(standardScaledTransformsTestObj).to.have.property(&apos;descale&apos;);
      expect(standardScaledTransformsTestObj).to.have.property(&apos;values&apos;);
      expect(standardScaledTransformsTestObj.scale).to.be.a(&apos;function&apos;);
      expect(standardScaledTransformsTestObj.descale).to.be.a(&apos;function&apos;);
      expect(standardScaledTransformsTestObj.values).to.be.an(&apos;array&apos;);
    });
    it(&apos;should have a values array that is equal to the array produced by StandardScaler function&apos;, () =&gt; {
      expect(standardScaledTransformsTestObj.values).to.eql(standardScaledTestArray);
    });
    it(&apos;should have a values array that is equal to the array produced by StandardScaler function&apos;, () =&gt; {
      expect(standardScaledTransformsTestObj.values).to.eql(standardScaledTestArray);
    });
    it(&apos;should properly scale single values&apos;, () =&gt; {
      expect(standardScaledTransformsTestObj.scale(testArray[0])).to.equal(standardScaledTestArray[0]);
      expect(standardScaledTransformsTestObj.scale(testArray[1])).to.equal(standardScaledTestArray[1]);
    });
    it(&apos;should properly descale single values&apos;, () =&gt; {
      expect(standardScaledTransformsTestObj.descale(standardScaledTestArray[0])).to.equal(testArray[0]);
      expect(standardScaledTransformsTestObj.descale(standardScaledTestArray[1])).to.equal(testArray[1]);
    });
  });
  describe(&apos;MinMax Scaler Transforms&apos;, () =&gt; { 
    const minMaxScaledTestArray = ms.util.MinMaxScaler(testArray);
    const minMaxScaledTransformsTestObj = ms.util.MinMaxScalerTransforms(testArray);
    it(&apos;should return an object with a scale function, descale function and values array&apos;, () =&gt; {
      expect(minMaxScaledTransformsTestObj).to.be.an(&apos;object&apos;);
      expect(minMaxScaledTransformsTestObj).to.have.property(&apos;scale&apos;);
      expect(minMaxScaledTransformsTestObj).to.have.property(&apos;descale&apos;);
      expect(minMaxScaledTransformsTestObj).to.have.property(&apos;values&apos;);
      expect(minMaxScaledTransformsTestObj.scale).to.be.a(&apos;function&apos;);
      expect(minMaxScaledTransformsTestObj.descale).to.be.a(&apos;function&apos;);
      expect(minMaxScaledTransformsTestObj.values).to.be.an(&apos;array&apos;);
      expect(minMaxScaledTransformsTestObj.values).to.eql(minMaxScaledTestArray);
    });
    it(&apos;should have a values array that is equal to the array produced by MinMaxScaler function&apos;, () =&gt; {
      expect(minMaxScaledTransformsTestObj.values).to.eql(minMaxScaledTestArray);
    });
    it(&apos;should properly scale single values&apos;, () =&gt; {
      expect(minMaxScaledTransformsTestObj.scale(testArray[0])).to.equal(minMaxScaledTestArray[0]);
      expect(minMaxScaledTransformsTestObj.scale(testArray[1])).to.equal(minMaxScaledTestArray[1]);
    });
    it(&apos;should properly descale single values&apos;, () =&gt; {
      expect(minMaxScaledTransformsTestObj.descale(minMaxScaledTestArray[0])).to.equal(testArray[0]);
      expect(minMaxScaledTransformsTestObj.descale(minMaxScaledTestArray[1])).to.equal(testArray[1]);
    });
  });
  describe(&apos;Log Scaler&apos;, () =&gt; { 
    it(&apos;should return log scaled values&apos;, () =&gt; {
      const logScaledTestArray = ms.util.LogScaler(testArray);
      expect(logScaledTestArray[ 0 ]).to.equal(Math.log(testArray[ 0 ]));
      expect(logScaledTestArray[ 3 ]).to.equal(Math.log(testArray[ 3 ]));
    });
  });
  describe(&apos;Exponent Scaler&apos;, () =&gt; {
    it(&apos;should return exponent scaled values&apos;, () =&gt; {
      const expScaledTestArray = ms.util.ExpScaler(testArray);
      expect(expScaledTestArray[ 0 ]).to.equal(Math.exp(testArray[ 0 ]));
      expect(expScaledTestArray[ 3 ]).to.equal(Math.exp(testArray[ 3 ]));
    });
  });
  describe(&apos;Standard Error of the Estimate&apos;, () =&gt; {
    const actuals = [2, 4, 5, 4, 5,];
    const estimates = [2.8, 3.4, 4, 4.6, 5.2,];
    it(&apos;should return the Standard Error of the Estimate&apos;, () =&gt; {
      const SE = ms.util.standardError(actuals, estimates);
      expect(SE.toFixed(2)).to.eql(0.89.toString());
    });
    it(&apos;should return an error if array lengths are not the same&apos;, () =&gt; {
      try {
        ms.util.standardError(actuals, [2,]);
      } catch (e) {
        expect(e).to.be.an(&apos;error&apos;);
      }
    });
  });
  describe(&apos;Coefficient of correlation&apos;, () =&gt; {
    const actuals = [ 39, 42, 67, 76, ];
    const estimates = [ 44, 40, 60, 84, ];
    it(&apos;should return the Coefficient of correlation&apos;, () =&gt; {
      const R = ms.util.coefficientOfCorrelation(actuals, estimates);
      expect(R.toFixed(4)).to.eql(0.9408.toString());

    });
    it(&apos;should return an error if array lengths are not the same&apos;, () =&gt; {
      try {
        ms.util.coefficientOfCorrelation(actuals, [2,]);
      } catch (e) {
        expect(e).to.be.an(&apos;error&apos;);
      }
    });
  });
  describe(&apos;rSquared&apos;, () =&gt; {
    const actuals = [ 39, 42, 67, 76, ];
    const estimates = [ 44, 40, 60, 84, ];
    it(&apos;should return r^2&apos;, () =&gt; {
      const R = ms.util.coefficientOfCorrelation(actuals, estimates);
      const rSquared = ms.util.rSquared(actuals, estimates);
      const COD = ms.util.coefficientOfDetermination(actuals, estimates);
      expect(Math.pow(R, 2)).to.eql(rSquared);
      expect(rSquared.toFixed(1)).to.eql(COD.toFixed(1));
    });
  });
  describe(&apos;Coefficient of determination&apos;, () =&gt; {
    const actuals = [2, 4, 5, 4, 5,];
    const estimates = [2.8, 3.4, 4, 4.6, 5.2,];
    it(&apos;should return the Coefficient of determination&apos;, () =&gt; {
      const r2 = ms.util.coefficientOfDetermination(actuals, estimates);
      expect(r2.toFixed(1)).to.eql(0.6.toString());
    });
    it(&apos;should return an error if array lengths are not the same&apos;, () =&gt; {
      try {
        ms.util.coefficientOfDetermination(actuals, [2,]);
      } catch (e) {
        expect(e).to.be.an(&apos;error&apos;);
      }
    });
  });
  describe(&apos;adjusted coefficient of determination&apos;, () =&gt; {
    it(&apos;should return the adjusted Coefficient of determination&apos;, () =&gt; {
      const adjr2 = ms.util.adjustedCoefficentOfDetermination({
        rSquared: 0.944346527,
        sampleSize: 8,
        independentVariables: 2,
      }); 
      expect(adjr2.toFixed(3)).to.eql(0.922.toString());
    });
  });
  describe(&apos;pivotVector&apos;, () =&gt; {
    it(&apos;should pivot vectors into arrays&apos;, () =&gt; {
      const arrays = ms.util.pivotVector(vectors); // =&gt; [ [1,2,3,3], [2,2,3,3], [3,3,4,3] ];
      expect(arrays[ 0 ]).to.be.lengthOf(4);
      expect(arrays[ 0 ]).to.eql([1, 1, 3, 3, ]);
      expect(arrays[ 1 ]).to.be.lengthOf(4);
      expect(arrays[ 1 ]).to.eql([2, 2, 3, 3, ]);
      expect(arrays[ 2 ]).to.be.lengthOf(4);
      expect(arrays[ 2 ]).to.eql([3, 3, 4, 3, ]);
    });
  });
  describe(&apos;pivotArrays&apos;, () =&gt; {
    it(&apos;should pivot arrays into vectors&apos;, () =&gt; {
      const translatedVectors = ms.util.pivotArrays(arrays);
      expect(translatedVectors).to.eql(vectors);
    });
  });
  describe(&apos;Z Scores / Standard Scores&apos;, () =&gt; {
    it(&apos;should calculate standard scores&apos;, () =&gt; {
      const observations = [
        7, 8, 8, 7.5, 9,
      ];
      const zscores = ms.util.standardScore(observations);
      const roundedZScores = zscores.map(z =&gt; parseFloat(z.toFixed(2), 10));
      expect(roundedZScores[ 3 ]).to.eql(-0.54);
      // console.log({ zscores,roundedZScores });
    });
    it(&apos;should approximate the p-value from the z score&apos;, () =&gt; { 
      const z1 = 2.87;
      const z2 = 1.96;
      const p1 = parseFloat(ms.util.approximateZPercentile(z1).toFixed(3), 10);
      const p2 = parseFloat(ms.util.approximateZPercentile(z2).toFixed(3), 10);
      const p3 = parseFloat(ms.util.approximateZPercentile(z1, false).toFixed(3), 10);
      const p4 = parseFloat(ms.util.approximateZPercentile(z2, false).toFixed(3), 10);
      expect(p1).to.eql(0.002);
      expect(p3).to.eql(0.998);
      expect(p2).to.eql(0.025);
      expect(p4).to.eql(0.975);
    });
  });
});</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
